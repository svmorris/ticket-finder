I had to get this done on a really tight schedule, this codebase is a mess. I promise to fix it soon :/
